<div class="container-fluid">
  <div class="row">
    <div class="col-md-12 mt-5 d-flex justify-content-center">
      <h2>メッセージ</h2>
    </div>
    
    <div class="col-md-12 mt-5 d-flex justify-content-center">
      <div class="table-responsive">
      <table class="table table-hover table-condensed">
        <thead>
          <tr>
            <th></th>
            <th>DM相手</th>
            <th>最新の会話</th>
            <th></th>
          </tr>
        </thead>
        
         <tbody>
            <% @users.each do |user| %>
           <tr>
             <td class="align-middle">
               <%= link_to chat_path(user) do %>
               <%= image_tag user.get_image(100,100), class: "rounded-circle" %>
               <% end %>
             </td>
             <td class="align-middle">
                <%= user.nickname %>
             </td>
             <td class="align-middle">
                <!--相手とのチャットルームの中で最新の会話を表示-->
                <%= Chat.where(room_id: user.user_rooms.pluck(:room_id)).last.message %>
             </td>
             <td class="align-middle">
               <%= link_to "トークルームへ", chat_path(user), class: "btn btn-success" %>
             </td>
           </tr>
           <% end %>
         </tbody>
         </table>
      </div>
    </div>
  </div>
</div>